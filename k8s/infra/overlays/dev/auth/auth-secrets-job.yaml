apiVersion: batch/v1
kind: Job

metadata:
  name: secrets-manager
spec:
  template:
    metadata:
      name: generate-auth-secrets
    spec:
      containers:
        - name: create-k8s-secret
          env:
            - name: SECRET_NAME
              valueFrom:
                configMapKeyRef:
                  name: auth-secrets-config
                  key: SECRET_NAME
            - name: NAMESPACE
              valueFrom:
                configMapKeyRef:
                  name: auth-secrets-config
                  key: NAMESPACE
      volumes:
        - name: scripts-volume
          configMap:
            name: auth-secrets-scripts
